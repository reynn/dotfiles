#!/usr/bin/env zsh

#+============================================================================+
# General
#+============================================================================+

CURRENT_HOST="$(hostname)"
DEBUG="${DEBUG:-false}"
GFP="$HOME/git"
REYNN="$GFP/github.com/reynn"
DFP="$REYNN/dotfiles"
DIR_BINS="$HOME/.bins"
HELP_JSON="$DFP/zsh/function_help.json"
HISTCONTROL='ignoreboth' # Omit duplicates and commands that begin with a space from history.
HISTSIZE='32768'         # Increase history size. Allow 32Â³ entries; the default is 500.
HISTFILESIZE="$HISTSIZE"
TERM='xterm-256color'
# Idealy this would be in .vars/python but right now this makes more sense
PYTHON_HOME="$(python3 -m site | grep USER_BASE | awk '{print $2}' | tr -d "\'")"

export PYTHON_HOME
export CURRENT_HOST
export DEBUG
export DFP
export DIR_BINS
export GFP
export HELP_JSON
export HISTCONTROL
export HISTFILESIZE
export HISTSIZE
export REYNN
export TERM

#+============================================================================+
# Arrays
#+============================================================================+

IMPORT_DIRECTORIES=()
  # Gather all of the directories in the zsh folder
  # Include hidden (-H) and gitignored (-I) dirs
  # Exclude .hosts and .completions
if test -r $DIR_BINS/fd; then
  IMPORT_DIRECTORIES+=($($DIR_BINS/fd -H -I -t d -d1 -E '.hosts' -E '.completions' . $DFP/zsh))
else
  IMPORT_DIRECTORIES+=($(find $DFP/zsh -type d -depth 1 | grep -v '.hosts' |grep -v '.completions'))
fi

POSSIBLE_PATHS=(
  "$DFP/scripts"
  "$GFP/bin"
  "$GFP/github.com/junegunn/fzf/bin"
  "$GFP/github.com/thecasualcoder/kube-fzf"
  "$HOME/.bins"
  "$HOME/.cargo/bin"
  "$PYTHON_HOME/bin"
  "$HOME/.yarn/bin"
  "$HOME/go/bin"
  "$PYENV_ROOT/bin"
  # Mac paths
  '/usr/local/MacGPG2/bin'
  # Unix paths
  '/usr/local/bin'
  '/snap/bin'
  '/usr/sbin'
  '/usr/bin'
  '/sbin'
  '/bin'
)
SSH_IDENTITIES=(id_rsa)

export IMPORT_DIRECTORIES
export POSSIBLE_PATHS
export SSH_IDENTITIES

#+============================================================================+
# XDG
#+============================================================================+

# Config home is defined in General section
# as it is within the dotfiles repo for now
XDG_BASE_PATH="$HOME/.xdg"
XDG_CACHE_HOME="$XDG_BASE_PATH/cache"
XDG_DATA_HOME="$XDG_BASE_PATH/data"
XDG_CONFIG_HOME="$XDG_BASE_PATH/configs"

export XDG_BASE_PATH
export XDG_CACHE_HOME
export XDG_DATA_HOME
export XDG_CONFIG_HOME

#+============================================================================+
# Unix (Paths/ENV overrides)
#+============================================================================+

PATH=''
EDITOR='nvim'
PYENV_ROOT="$GFP/github.com/pyenv/pyenv"
SSH_KEY_PATH='~/.ssh/rsa_id'
UPDATE_ZSH_DAYS='3'

export EDITOR
export PYENV_ROOT
export SSH_KEY_PATH
export UPDATE_ZSH_DAYS

#+============================================================================+
# Unix (Special modifications)
#+============================================================================+

function load_paths {
  for p in $POSSIBLE_PATHS; do
    # Test if the directory exists
    if test -d $p; then
      # Test if the existing PATH variable is set to anything
      if test -z $PATH; then
        PATH="$p"
      else
        PATH="$PATH:$p"
      fi
    fi
  done

  export PATH
}
load_paths
